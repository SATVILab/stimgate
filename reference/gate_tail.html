<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Constructs a cutpoint for a flowFrame by using a derivative of the kernel density estimate — .cytokine_cutpoint • stimgate</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Constructs a cutpoint for a flowFrame by using a derivative of the kernel density estimate — .cytokine_cutpoint"><meta name="description" content="We determine a gating cutpoint using either the first or second derivative of
the kernel density estimate (KDE) of the x."><meta property="og:description" content="We determine a gating cutpoint using either the first or second derivative of
the kernel density estimate (KDE) of the x."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">stimgate</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.1-1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/stimgate.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/SATVILab/stimgate" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Constructs a cutpoint for a flowFrame by using a derivative of the kernel density estimate</h1>
      <small class="dont-index">Source: <a href="https://github.com/SATVILab/stimgate/blob/master/R/cytoUtils-cytokine_cutpoint.R" class="external-link"><code>R/cytoUtils-cytokine_cutpoint.R</code></a></small>
      <div class="d-none name"><code>gate_tail.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>We determine a gating cutpoint using either the first or second derivative of
the kernel density estimate (KDE) of the <code>x</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">.cytokine_cutpoint</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  num_peaks <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ref_peak <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"first_deriv"</span>, <span class="st">"second_deriv"</span><span class="op">)</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  adjust <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  side <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>  strict <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  auto_tol <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a <code>numeric</code> vector used as input data</p></dd>


<dt id="arg-num-peaks">num_peaks<a class="anchor" aria-label="anchor" href="#arg-num-peaks"></a></dt>
<dd><p>the number of peaks expected to see. This effectively removes
any peaks that are artifacts of smoothing</p></dd>


<dt id="arg-ref-peak">ref_peak<a class="anchor" aria-label="anchor" href="#arg-ref-peak"></a></dt>
<dd><p>After <code>num_peaks</code> are found, this argument provides the
index of the reference population from which a gate will be obtained. By
default, the peak farthest to the left is used.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>the method used to select the cutpoint. See details.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>the tolerance value</p></dd>


<dt id="arg-adjust">adjust<a class="anchor" aria-label="anchor" href="#arg-adjust"></a></dt>
<dd><p>the scaling adjustment applied to the bandwidth used in the
first derivative of the kernel density estimate</p></dd>


<dt id="arg-side">side<a class="anchor" aria-label="anchor" href="#arg-side"></a></dt>
<dd><p>character specifying the side of the gate, either
<code>'right'</code> (default) or <code>'left'</code></p></dd>


<dt id="arg-strict">strict<a class="anchor" aria-label="anchor" href="#arg-strict"></a></dt>
<dd><p><code>logical</code> when the actual number of peaks detected is less than <code>ref_peak</code>.
an error is reported by default. But if <code>strict</code> is set to FALSE, then the reference peak will be reset to the peak of the far right.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>logical specifying whether to plot the peaks found</p></dd>


<dt id="arg-auto-tol">auto_tol<a class="anchor" aria-label="anchor" href="#arg-auto-tol"></a></dt>
<dd><p>when TRUE, it tries to set the tolerance automatically.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed to <code>.deriv_density</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>the cutpoint along the x-axis</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>By default, we compute the first derivative of the kernel density estimate.
Next, we determine the lowest valley from the derivative, which corresponds to the
density's mode for cytokines. We then contruct a gating cutpoint as the value
less than the tolerance value <code>tol</code> in magnitude and is also greater
than the lowest valley.</p>
<p>Alternatively, if the <code>method</code> is selected as <code>second_deriv</code>, we
select a cutpoint from the second derivative of the KDE. Specifically, we
choose the cutpoint as the largest peak of the second derivative of the KDE
density which is greater than the reference peak.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/miguelrodo" class="external-link">Miguel Rodo</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

